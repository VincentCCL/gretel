$(function(){function t(){!x&&y<=phpVars.resultsLimit&&($(".loading-wrapper.searching").addClass("active"),c=$.ajax(phpVars.fetchResultsPath).done(function(t){if(!x&&!I){var e=$.parseJSON(t);!e.error&&e.data?(v.find("tbody.empty").hide(),o(e.data,!1)):($(".loading-wrapper.searching").removeClass("active"),w.closest(".results-messages-wrapper").addClass("active"),b.addClass("active"),e.error?r(e.data):0==v.find("tbody:not(.empty)").children().length?s():a(),clearTimeout(S),x=!0,I=!0,l&&l.abort(),p&&p.abort())}}).fail(function(t,e,n){if("abort"!=n){var a="An error occurred";""!=n&&(a+=": "+n+"."),r(a)}}).always(function(){y!=f||x||I||e()}))}function e(){l||(clearTimeout(S),l=$.ajax(phpVars.getAllResultsPath).done(function(t){var e=$.parseJSON(t);!e.error&&e.data?(v.find("tbody.empty").hide(),o(e.data,!0)):($(".loading-wrapper.searching").removeClass("active"),w.children("div").removeClass("error notice").closest(".results-messages-wrapper").show(),b.addClass("active"),e.error?r(e.data):0==v.find("tbody:not(.empty)").children().length&&s())}).fail(function(t,e,n){"abort"!=n&&r("An error occurred: "+n+".")}).always(function(){x=!0,c&&c.abort()}))}function n(t){return Number.isInteger(t)&&t>999?t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):t}function a(){i(),h.removeClass("results-loading").addClass("results-done"),w.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php?sid="+phpVars.sid+" #results-found",function(){V&&(w.find(".amount-hits").html(n(parseInt(k))),w.find(".is-still-counting").remove()),y<phpVars.resultsLimit&&(null!=p&&(p.abort(),p=null),countString=m.find(".count strong").text(),m.find(".count strong + span").text(countString),w.find(".amount-hits").text(countString),w.find(".is-still-counting").remove()),w.children("div").removeClass("error").addClass("notice active").closest(".results-messages-wrapper").show(),b.addClass("active"),C.show()})}function s(){h.removeClass("results-loading").addClass("results-none"),v.add(m).remove(),b.addClass("no-results"),h.addClass("search-no-results"),w.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php?sid="+phpVars.sid+" #no-results-found",function(){w.children("div").removeClass("notice").addClass("error active").closest(".results-messages-wrapper").show()})}function r(t){h.removeClass("results-loading").addClass("results-failed"),v.add(m).remove(),b.addClass("error"),h.addClass("search-error"),w.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php?sid="+phpVars.sid+" #error",function(){w.find(".error-msg").text(t).after('<p>If this error persists, please do not hesitate to <a href="documentation.php#faq-4" title="How can you contact us?">contact us</a>!</p>'),w.children("div").removeClass("notice").addClass("error active").closest(".results-messages-wrapper").show()})}function o(e,s){s&&(x=!0,y=0,v.find("tbody:not(.empty)").empty()),$.each(e,function(t,e){if(s||!s&&!x){y++;var n=e[0];n=n.replace(/\bhref=\"([^"]+)\"/,'href="#tv-'+y+'" data-tv-url="$1"'),v.find("tbody:not(.empty)").append('<tr data-result-id="'+y+'" data-component="'+e[2]+'"><td>'+y+"</td><td>"+n+"</td><td>"+e[2]+"</td><td>"+e[1]+"</td></tr>")}}),resultIDString=n(parseInt(y)),m.find(".count strong").text(resultIDString),s||x?a():t()}function i(){$("[for='filter-components'], .filter-sel-wrapper label").removeClass("disabled").children("input").prop("disabled",!1),g.find("[type='checkbox'][name='component']").each(function(t,e){var n=$(e),a=n.val();0==v.find("tbody:not(.empty) tr[data-component^='"+a+"']").length&&(n.prop("disabled",!0),n.prop("checked",!1),n.parent("label").addClass("disabled"))})}function d(){null!=l&&(l.abort(),l=null),null!=p&&(p.abort(),p=null),null!=c&&(c.abort(),c=null),x=!0}var l,c,p,f=4,u=(window.location.hash,$(window),$(document)),h=$("body"),m=$(".controls"),v=$(".results-ajax-wrapper"),g=$(".filter-sel-wrapper"),b=$("#download-overview .flex-content"),w=b.find(".messages"),C=$(".notification-wrapper"),y=0,k=0,x=!1,V=!1,I=!1;t(),p=$.ajax(phpVars.fetchCountsPath).done(function(t){var e=$.parseJSON(t);if(!e.error&&e.sum&&e.counts){var a=e.sum,s=e.counts;if(k=a,a=n(parseInt(a)),m.find(".count strong + span").text(a),w.find(".amount-hits").text(a),w.find(".is-still-counting").remove(),h.removeClass("counts-loading"),h.addClass("counts-done"),k>0){var r=Object.keys(s).length;if(void 0!==s&&r>0){var o=0,i=0;for(var d in s){var l=d.split("_")[2],c=n(parseInt(s[d][0])),p=n(parseInt(s[d][1]));o+=parseInt(s[d][0]),i+=parseInt(s[d][1]),b.find(".distribution-wrapper tbody").append("<tr><td>"+l+"</td><td>"+c+"</td><td>"+p+"</td></tr>")}b.find(".distribution-wrapper tbody").append("<tr><th>Total</th><th>"+n(o)+"</th><th>"+n(i)+"</th></tr>"),b.find(".distribution-wrapper").show()}k>phpVars.resultsLimit&&w.find(".is-restricted").show()}}}).fail(function(t,e,n){"abort"!=n&&r("An error occurred: "+n+".")}).always(function(){V=!0}),h.addClass("results-loading counts-loading");var S=setTimeout(function(){e()},500);u.click(function(t){m.find(".filter-wrapper").hasClass("active")&&($(t.target).closest(".filter-wrapper").length||m.find(".filter-wrapper").removeClass("active"))}),m.find("[for='filter-components']").click(function(){$(this).parent().addClass("active")}),g.find("[type='checkbox']").change(function(){var t=$(this),e=t.val();$("#all-components").prop("indeterminate",!1),t.is("[name='component']")?(t.is(":checked")?v.find("tbody:not(.empty) tr[data-component^='"+e+"']").show():v.find("tbody:not(.empty) tr[data-component^='"+e+"']").hide(),g.find("[name='component']").is(":checked")?(g.find("[name='component']:not(:disabled)").length==g.find("[name='component']:not(:disabled):checked").length?g.find("#all-components").prop("checked",!0).parent().addClass("active"):g.find("#all-components").prop("checked",!1).prop("indeterminate",!0).parent().removeClass("active"),v.find(".empty").hide()):(v.find(".empty").css("display","table-row-group").find("td").text("No results matching the specified filters"),g.find("#all-components").prop("checked",!1).parent().removeClass("active"))):t.is("#all-components")&&(t.parent().toggleClass("active"),g.find("[type='checkbox'][name='component']:not(:disabled)").prop("checked",t.is(":checked")).change())}),window.addEventListener("beforeunload",function(){d()}),$(".secondary-navigation a").click(function(){d()}),v.find("tbody").on("click","a.tv-show-fs",function(t){var e=$(this),n=e.parent().nextAll("td:last-child").html(),a=$("#tree-visualizer-fs");v.find("tbody a").removeClass("tv-toggled-link"),this.hasAttribute("data-tv-fontsize")||e.attr("data-tv-fontsize",0),a.attr("data-tv-active-index",e.closest("tr").index()),e.addClass("tv-toggled-link"),h.treeVisualizer(e.data("tv-url"),{normalView:!1,initFSOnClick:!0,sentence:n,hasNavigation:!0}),t.preventDefault()}),C.find("button").click(function(){C.hide()}),C.find("a").click(function(t){t.preventDefault(),$("html, body").stop().animate({scrollTop:$("#download-overview").offset().top},150),C.fadeOut("fast")}),$("#results-menu a").off("click").click(function(t){$("html, body").stop().animate({scrollTop:$($(this).attr("href")).offset().top},150),t.preventDefault()})});