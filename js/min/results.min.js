$(function(){function t(){!I&&x<=phpVars.resultsLimit&&($(".loading-wrapper.searching").addClass("active"),p=$.ajax(phpVars.fetchResultsPath).done(function(t){if(!I&&!O){var e=$.parseJSON(t);!e.error&&e.data?(b.find("tbody.empty").hide(),i(e.data,!1)):($(".loading-wrapper.searching").removeClass("active"),y.closest(".results-messages-wrapper").addClass("active"),C.addClass("active"),e.error?o(e.data):0==b.find("tbody:not(.empty)").children().length?s():a(),clearTimeout(P),I=!0,O=!0,c&&c.abort(),f&&f.abort())}}).fail(function(t,e,n){if("abort"!=n){var a="An error occurred";""!=n&&(a+=": "+n+"."),o(a)}}).always(function(){x!=u||I||O||e()}))}function e(){c||(clearTimeout(P),c=$.ajax(phpVars.getAllResultsPath).done(function(t){var e=$.parseJSON(t);!e.error&&e.data?(b.find("tbody.empty").hide(),i(e.data,!0)):($(".loading-wrapper.searching").removeClass("active"),y.children("div").removeClass("error notice").closest(".results-messages-wrapper").show(),C.addClass("active"),e.error?o(e.data):0==b.find("tbody:not(.empty)").children().length&&s())}).fail(function(t,e,n){"abort"!=n&&o("An error occurred: "+n+".")}).always(function(){I=!0,p&&p.abort()}))}function n(t){return Number.isInteger(t)&&t>999?t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):t}function a(){d(),v.removeClass("results-loading").addClass("results-done"),y.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php #results-found",function(){S&&(y.find(".amount-hits").html(n(parseInt(V))),y.find(".is-still-counting").remove()),x<phpVars.resultsLimit&&(null!=f&&(f.abort(),f=null),countString=g.find(".count strong").text(),g.find(".count strong + span").text(countString),y.find(".amount-hits").text(countString),y.find(".is-still-counting").remove()),y.children("div").removeClass("error").addClass("notice active").closest(".results-messages-wrapper").show(),C.addClass("active"),k.show()})}function s(){v.removeClass("results-loading").addClass("results-none"),b.add(g).remove(),C.addClass("no-results"),v.addClass("search-no-results"),y.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php #no-results-found",function(){y.children("div").removeClass("notice").addClass("error active").closest(".results-messages-wrapper").show()})}function o(t){v.removeClass("results-loading").addClass("results-failed"),b.add(g).remove(),C.addClass("error"),v.addClass("search-error"),y.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php #error",function(){y.find(".error-msg").text(t).after('<p>If this error persists, please do not hesitate to <a href="documentation.php#faq-4" title="How can you contact us?">contact us</a>!</p>'),y.children("div").removeClass("notice").addClass("error active").closest(".results-messages-wrapper").show()})}function r(){if(!v.hasClass("tv-fs-open")&&1==h.indexOf("tv-")){var t=h.match(/\d+$/);$("a.tv-show-fs").eq(t[0]-1).click()}}function i(e,s){s&&(I=!0,x=0,b.find("tbody:not(.empty)").empty()),$.each(e,function(t,e){if(s||!s&&!I){x++;var n=e[0];n=n.replace(/\bhref=\"([^"]+)\"/,'href="#tv-'+x+'" data-tv-url="$1"'),b.find("tbody:not(.empty)").append('<tr data-result-id="'+x+'" data-component="'+e[2]+'"><td>'+x+"</td><td>"+n+"</td><td>"+e[2]+"</td><td>"+e[1]+"</td></tr>")}r()}),resultIDString=n(parseInt(x)),g.find(".count strong").text(resultIDString),s||I?a():t()}function d(){$("[for='filter-components'], .filter-sel-wrapper label").removeClass("disabled").children("input").prop("disabled",!1),w.find("[type='checkbox'][name='component']").each(function(t,e){var n=$(e),a=n.val();0==b.find("tbody:not(.empty) tr[data-component^='"+a+"']").length&&(n.prop("disabled",!0),n.prop("checked",!1),n.parent("label").addClass("disabled"))})}function l(){null!=c&&(c.abort(),c=null),null!=f&&(f.abort(),f=null),null!=p&&(p.abort(),p=null),I=!0}var c,p,f,u=4,h=window.location.hash,m=($(window),$(document)),v=$("body"),g=$(".controls"),b=$(".results-ajax-wrapper"),w=$(".filter-sel-wrapper"),C=$("#download-overview .flex-content"),y=C.find(".messages"),k=$(".notification-wrapper"),x=0,V=0,I=!1,S=!1,O=!1;t(),function(){f=$.ajax(phpVars.fetchCountsPath).done(function(t){var e=$.parseJSON(t);if(console.log(e),!e.error&&e.sum&&e.counts){var a=e.sum,s=e.counts;if(V=a,a=n(parseInt(a)),g.find(".count strong + span").text(a),y.find(".amount-hits").text(a),y.find(".is-still-counting").remove(),v.removeClass("counts-loading"),v.addClass("counts-done"),V>0){var o=Object.keys(s).length;if(void 0!==s&&o>0){var r=0,i=0;for(var d in s){var l=d.split("_")[2],c=n(parseInt(s[d][0])),p=n(parseInt(s[d][1]));r+=parseInt(s[d][0]),i+=parseInt(s[d][1]),C.find(".distribution-wrapper tbody").append("<tr><td>"+l+"</td><td>"+c+"</td><td>"+p+"</td></tr>")}C.find(".distribution-wrapper tbody").append("<tr><th>Total</th><th>"+n(r)+"</th><th>"+n(i)+"</th></tr>"),C.find(".distribution-wrapper").show()}V>phpVars.resultsLimit&&y.find(".is-restricted").show()}}}).fail(function(t,e,n){"abort"!=n&&o("An error occurred: "+n+".")}).always(function(){S=!0})}(),v.addClass("results-loading counts-loading");var P=setTimeout(function(){e()},500);h&&1==h.indexOf("tv-")&&y.load(phpVars.fetchHomePath+"/front-end-includes/results-messages.php #looking-for-tree",function(){y.children("div").removeClass("error").addClass("notice active").closest(".results-messages-wrapper").show(),C.addClass("active")}),m.click(function(t){g.find(".filter-wrapper").hasClass("active")&&($(t.target).closest(".filter-wrapper").length||g.find(".filter-wrapper").removeClass("active"))}),g.find("[for='filter-components']").click(function(){$(this).parent().addClass("active")}),w.find("[type='checkbox']").change(function(){var t=$(this),e=t.val();$("#all-components").prop("indeterminate",!1),t.is("[name='component']")?(t.is(":checked")?b.find("tbody:not(.empty) tr[data-component^='"+e+"']").show():b.find("tbody:not(.empty) tr[data-component^='"+e+"']").hide(),w.find("[name='component']").is(":checked")?(w.find("[name='component']:not(:disabled)").length==w.find("[name='component']:not(:disabled):checked").length?w.find("#all-components").prop("checked",!0).parent().addClass("active"):w.find("#all-components").prop("checked",!1).prop("indeterminate",!0).parent().removeClass("active"),b.find(".empty").hide()):(b.find(".empty").css("display","table-row-group").find("td").text("No results matching the specified filters"),w.find("#all-components").prop("checked",!1).parent().removeClass("active"))):t.is("#all-components")&&(t.parent().toggleClass("active"),w.find("[type='checkbox'][name='component']:not(:disabled)").prop("checked",t.is(":checked")).change())}),window.addEventListener("beforeunload",function(){l()}),$(".secondary-navigation a").click(function(){l()}),b.find("tbody").on("click","a.tv-show-fs",function(t){var e=$(this),n=e.parent().nextAll("td:last-child").html(),a=$("#tree-visualizer-fs");b.find("tbody a").removeClass("tv-toggled-link"),this.hasAttribute("data-tv-fontsize")||e.attr("data-tv-fontsize",0),a.attr("data-tv-active-index",e.closest("tr").index()),e.addClass("tv-toggled-link"),v.treeVisualizer(e.data("tv-url"),{normalView:!1,initFSOnClick:!0,sentence:n,hasNavigation:!0}),t.preventDefault()}),k.find("button").click(function(){k.hide()}),k.find("a").click(function(t){t.preventDefault(),$("html, body").stop().animate({scrollTop:$("#download-overview").offset().top},150),k.fadeOut("fast")}),$("#results-menu a").off("click").click(function(t){$("html, body").stop().animate({scrollTop:$($(this).attr("href")).offset().top},150),t.preventDefault()})});